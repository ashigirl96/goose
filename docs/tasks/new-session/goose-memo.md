# Goose Planner 構想分析

## 概要
この文書は、`memo.md`に記載された新しいGoose Plannerの構想を構造化し、解析したものです。目標、機能要件、実装方法、課題点を明確にし、実現可能性の評価を提供します。

## 目的と背景
Goose Plannerは以下の課題を解決することを目指しています：

- タスク管理のイニシャルコストの削減
- Memory Bankの統合
- MCP呼び出しやコミットの自動化
- プランのレビューコスト削減
- 依存関係の管理改善

## 提案されているモード構成

### 1. Investor Mode（調査モード）
**目的**: 情報収集と分析

**実装方法**:
- `investments/` ディレクトリに調査結果を保存
- URLからの情報取得と要約
- 調査結果の構造化（要約、コードスニペット、図表など）

**実現可能性**: 高
- 既存のfetch機能と連携可能
- 情報の構造化は現在のLLM能力で十分実現可能

### 2. Planner Mode（計画モード）
**目的**: タスクの目標設定と計画立案

**実装方法**:
- `tasks/<task-name>/{plan, todo}.md` ファイル作成
- 目的の明確化と確認プロセス
- `persistent-contexts`と`investments`からの関連情報収集
- 実行計画の策定とレビュー

**実現可能性**: 中〜高
- ファイル構造の管理は比較的単純
- 関連情報の自動収集はLLMのコンテキスト理解能力に依存

### 3. Executor Mode（実行モード）
**目的**: 計画の実行と進捗管理

**実装方法**:
- 計画と関連ファイルの読み込み
- タスクの実行と進捗追跡（`todo.md`のチェック管理）
- 実行中の学びを`persistent`ディレクトリに反映

**実現可能性**: 中
- タスク実行の自動化は複雑度が高い
- 特に依存関係の解決が課題

### 4. Architect Mode（設計モード）
**目的**: プロジェクト構造の初期化と管理

**実装方法**:
- `persistents/`ディレクトリでアーキテクチャ構造を管理
- ファイル初期化機能（Claude Codeの`/init`に類似）
- 特定ファイルの更新機能

**実現可能性**: 中〜低
- プロジェクト構造の理解と自動生成は複雑
- 特に大規模プロジェクトでの実装が難しい可能性

## 共通機能と統合要素

### メモリ管理
- `.goose/memory`と`docs/persistent`の連携
- 学習内容の自動更新メカニズム

### タスク管理システム
- タスクディレクトリとセッションファイルの関連付け
- 完了タスクの`archive`ディレクトリへの移動

### MCP（Multi-Context Process）連携
- MCPの非同期呼び出し
- レビューモードでの自動修正提案
- キューイングシステム

### ドキュメント標準
- Mermaid図表はmonokaiテーマを使用
- 調査・計画・実行の文書テンプレート

## 課題と実装の難点

1. **現行のplan/actモデルの問題点**:
   - タスク開始のコスト
   - Memory Bank未統合
   - 手動のMCP呼び出しとコミット
   - レビューコストの高さ
   - 変更箇所が多い場合の見落とし
   - 依存関係解決の難しさ
   - 複数のMCPサーバー稼働のリソース消費

2. **技術的課題**:
   - 非同期処理の実装
   - 多モード間の状態管理
   - コンテキスト理解の深さ
   - 自動コード生成と修正の精度

3. **未解決の検討事項**:
   - カテゴリの想起メカニズム
   - プロジェクト単位の長期タスク管理
   - PRの紐付け方法
   - 裏側でのlint/prettier監視の実装方法

## 実現に向けた優先度と推奨アプローチ

### 高優先度（比較的実現しやすい）
1. ディレクトリ構造の設計と実装
   - `tasks/`, `investments/`, `persistents/` の基本構造
   - タスク状態管理（アクティブ・アーカイブ）

2. メモリ管理システムの拡張
   - 既存の`.goose/memory`との統合
   - カテゴリ・タグによる検索機能の強化

3. ドキュメント生成テンプレート
   - 各モード用の標準テンプレート
   - Mermaid図表のスタイル統一

### 中優先度（技術的課題あり）
1. Investor/Planner機能の実装
   - 情報収集と要約機能
   - 計画立案と構造化

2. MCP連携の基本機能
   - 単一の修正提案と実装
   - コミット前チェック機能

### 低優先度（難易度高）
1. 完全な非同期処理システム
   - セッションとMCPの並行処理

2. 高度な依存関係解決
   - プラン時点での依存チェック
   - 自動修正提案

3. Architect Modeの完全実装
   - プロジェクト構造の自動理解と生成

## 結論

Goose Plannerの構想は、開発プロセスを効率化する優れた設計理念を含んでいます。モード分割による責務の明確化は実装の方向性として適切です。

段階的なアプローチとして、まずはディレクトリ構造とメモリ管理、基本的なInvestor/Planner機能から実装を開始し、徐々に高度な機能を追加していくことが推奨されます。特にMCPとの非同期連携については、シンプルな形での実装から始め、機能検証の上で拡張していくべきでしょう。

最もハードルが高いのはArchitect Modeの完全実装と高度な依存関係解決ですが、これらは長期的な目標として設定し、基本機能の安定後に取り組むことが現実的です。