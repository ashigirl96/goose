# Goose レシピ機能ガイド

## 概要

Gooseのレシピ（Recipe）は、Gooseとの対話セッションを事前に構成・設定するための強力な仕組みです。YAMLまたはJSONファイルを通じて、特定の目的や用途に合わせたカスタマイズされたAI体験を定義できます。レシピを使用することで、繰り返し利用する設定を簡単に共有・再利用できるようになります。

## レシピの構造

レシピファイルは以下の要素を持つYAMLまたはJSONファイルとして定義されます：

```yaml
version: "1.0.0"              # レシピバージョン
title: "タイトル"             # レシピのタイトル（必須）
description: "説明文"        # レシピの説明（必須）
instructions: "指示文..."    # AIへのシステム指示（instructions または prompt が必須）
prompt: "初期プロンプト..."   # セッション開始時の最初のメッセージ（オプション）
extensions: ["拡張機能1", "拡張機能2"] # 使用する拡張機能のリスト（オプション）
```

### 必須項目

- **title**: レシピの名前を表す短いタイトル
- **description**: レシピの目的や使用方法を説明する詳細な説明
- **instructions** または **prompt**: 少なくともいずれか一方が必要
  - instructions: AIの振る舞いを定義するシステム指示
  - prompt: ユーザーからの最初のメッセージとして使用されるテキスト

### オプション項目

- **version**: レシピのバージョン（デフォルトは "1.0.0"）
- **extensions**: 使用する拡張機能のリスト
- **context**: 追加のコンテキスト情報

## 動的パラメータの使用

Gooseレシピは動的パラメータをサポートしており、レシピファイル内で変数を使用できます。この機能により、同じレシピテンプレートを異なるコンテキストで再利用できます。

### 変数構文

レシピファイル内で `{{ 変数名 }}` の形式で変数を宣言します：

```yaml
instructions: "あなたは{{ 会社名 }}の社員向けアシスタントです。{{ ユーザー名 }}さんをサポートしてください。"
prompt: "こんにちは、{{ ユーザー名 }}さん！何かお手伝いできることはありますか？"
```

### コマンドラインからの変数指定

レシピを実行する際に、`--params` オプションを使用して変数に値を渡します：

```bash
goose --recipe my_recipe.yaml --params ユーザー名=田中 --params 会社名=株式会社Goose
```

複数の `--params` オプションを指定することで、複数の変数に値を設定できます。

## レシピの使用方法

### 基本的な使用法

```bash
goose --recipe my_recipe.yaml
```

### パラメータを使った動的カスタマイズ

```bash
goose --recipe my_recipe.yaml --params ユーザー名=田中 --params プロジェクト=Goose開発
```

### レシピの検証

レシピファイルの構文と必須項目を検証します：

```bash
goose recipe validate my_recipe.yaml
```

### レシピのディープリンク生成

レシピを他のユーザーと共有するためのディープリンクを生成します：

```bash
goose recipe deeplink my_recipe.yaml
```

生成されたディープリンクは、Goose Desktopアプリで開くことができます。

## ユースケース例

### プロジェクト固有のアシスタント

```yaml
title: "プロジェクトXアシスタント"
description: "プロジェクトXの開発者向けカスタムアシスタント"
instructions: "あなたは{{ プロジェクト名 }}の開発をサポートするアシスタントです。以下の技術スタックに詳しいエキスパートとして振る舞ってください: {{ 技術スタック }}"
extensions: ["github", "developer", "memory"]
```

### 会社固有のナレッジアシスタント

```yaml
title: "社内ナレッジベースアシスタント"
description: "{{ 会社名 }}の社内規則や手順に関するガイド"
instructions: "あなたは{{ 会社名 }}の社員向け内部ガイドです。社内規則、手順、ベストプラクティスについて質問に答えてください。"
```

## 利点

- **一貫性**: 同じレシピを使うことで、チーム全体で一貫したAI体験が得られます
- **効率性**: 毎回同じ指示を書く必要がなく、時間を節約できます
- **カスタマイズ性**: パラメータを変えるだけで様々な状況に対応できます
- **再現性**: 特定の設定を再現しやすくなります
- **共有可能**: チーム内でベストプラクティスを共有できます

## 技術的実装

レシピ機能は内部的に [minijinja](https://docs.rs/minijinja/latest/minijinja/) テンプレートエンジンを使用しており、レシピファイルをレンダリングする際に指定されたパラメータを適用します。これにより、静的なテンプレートを動的なコンテンツに変換する柔軟な仕組みを提供しています。

## 制限事項

- すべての必須変数は実行時に値を提供する必要があります。未定義の変数があるとエラーになります。
- 複雑なロジック（条件分岐など）はサポートされていません。

---

レシピ機能は、Gooseとの対話をより構造化・標準化し、特定のタスクや役割に特化したAIアシスタントを簡単に構成するための強力なツールです。チーム間でベストプラクティスを共有し、一貫した高品質な対話体験を提供するのに役立ちます。